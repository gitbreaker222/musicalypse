<div class="wrapper">
  <mat-chip-list class="full-list mat-elevation-z3" [class.show]="showChipList" (click)="showChipList = false">
    <mat-chip *ngFor="let artist of library.selectedArtists"
              (click)="scrollTo(artist.name); showChipList = false">
      <span class="chip-text">{{artist.name}}</span>
      <mat-icon matChipRemove (click)="library.deselectArtist(artist); $event.stopPropagation()">cancel</mat-icon>
    </mat-chip>
    <mat-chip class="remove-all" (click)="library.deselectAllArtists()">Remove All</mat-chip>
  </mat-chip-list>
  <div class="controls divider fake-scroll-y">
    <mat-form-field floatLabel="never" class="search" [class.show]="showSearch">
      <input #searchInput matInput title="Search" [(ngModel)]="search" (keyup)="filter()" spellcheck="false">
      <mat-placeholder>
        <mat-icon>search</mat-icon>
        Search an artist
      </mat-placeholder>
      <button mat-button *ngIf="search" matSuffix mat-icon-button aria-label="Clear" (click)="search=''; filter()">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
    <div class="controls-meta" [class.show]="!showSearch">
      <span class="select-text" *ngIf="library.selectedArtists.length == 0">
        Select an artist or
        <mat-chip (click)="library.selectAllArtists()">Select All</mat-chip>
      </span>
      <mat-chip-list>
        <mat-chip *ngFor="let artist of library.selectedArtists.length <= 2 ? library.selectedArtists : library.selectedArtists.slice(0,1)"
                  (click)="scrollTo(artist.name)">
          <span class="chip-text">{{artist.name}}</span>
          <mat-icon matChipRemove (click)="library.deselectArtist(artist)">cancel</mat-icon>
        </mat-chip>
        <mat-chip *ngIf="library.selectedArtists.length > 2"
                  (click)="showChipList = !showChipList"
                  class="chip-more">
          {{library.selectedArtists.length - 1}} moreâ€¦
        </mat-chip>
      </mat-chip-list>
    </div>
    <button mat-button mat-icon-button
            (click)="showSearch = !showSearch; showSearch ? searchInput.focus() : {}"
            class="searchButton">
      <mat-icon>search</mat-icon>
    </button>
    <!--<button mat-button mat-icon-button-->
            <!--class="more"-->
            <!--[matMenuTriggerFor]="moreArtistMenu">-->
      <!--<mat-icon>more_vert</mat-icon>-->
    <!--</button>-->
    <!--<mat-menu #moreArtistMenu>-->
      <!--<button mat-menu-item (click)="selectAll()">-->
        <!--<mat-icon>select_all</mat-icon>-->
        <!--<span>Select all</span>-->
      <!--</button>-->
      <!--<button mat-menu-item (click)="sortAlphabetically()">-->
        <!--<mat-icon>sort_by_alpha</mat-icon>-->
        <!--<span>Sort alphabetically</span>-->
      <!--</button>-->
      <!--<button mat-menu-item (click)="sortBySongs()">-->
        <!--<mat-icon>sort</mat-icon>-->
        <!--<span>Sort by number of songs</span>-->
      <!--</button>-->
    <!--</mat-menu>-->
  </div>
  <div #list class="list-wrapper" (swipeleft)="onNext.emit()">
    <mat-list class="artists" dense>
      <ng-container *ngFor="let artist of filteredArtists; trackBy: trackByName">
        <a class="artist hover" (click)="library.selectArtist(artist); onNext.emit();" mat-list-item>
          <mat-checkbox
            color="primary"
            matListIcon
            [checked]="library.isSelectedArtist(artist)"
            (change)="$event.checked ? library.addArtist(artist) : library.removeArtist(artist)"
            (click)="$event.stopPropagation()"></mat-checkbox>
          <div matListAvatar class="avatar" [style]="getAvatarStyle(artist)">
            <mat-icon *ngIf="!artist.avatarUrl">music_note</mat-icon>
          </div>
          <div matLine class="primary-text">
            <mat-icon *ngIf="artist.warn && settings.warnOnMissingTags" color="warn" matTooltip="Unset tags!">warning</mat-icon>
            <span class="artist-name" [innerHtml]="artist.name | sgSearch:search"></span>
          </div>
          <div matLine class="secondary-text">{{artist.songs}} songs</div>
          <button mat-button mat-icon-button
                  (click)="library.addArtist(artist); onNext.emit(); $event.stopPropagation()">
            <mat-icon>keyboard_arrow_right</mat-icon>
          </button>
          <mat-divider></mat-divider>
        </a>
      </ng-container>
    </mat-list>
  </div>
  <div class="alphabet" (click)="$event.stopPropagation()">
    <ol>
      <li *ngFor="let letter of alphabet" (click)="scrollTo(letter)">{{letter}}</li>
    </ol>
  </div>
</div>
